# cadr4

Experiments of the third kind...  This is an attempt at making a
faithful and accurate HDL implementation of CADR.  There will be no
attempt at making this synthesizable (at this time)!

## Random chit-chat

There is a IRC channel on irc.libera.net, ##lispm for random
chit-chat.  Feel free to send bugs directly to ams@gnu.org.

## Setup

### Prerequisites

- Git
- GNU Make
- Python 3
- [GHDL](http://ghdl.free.fr/) with the GCC or LLVM code generator
- optionally some sort of VCD viewer:
  - [Surfer](https://surfer-project.org)
  - [GTKWave](https://gtkwave.sourceforge.net/)
  
### Build

```
git clone https://github.com/ams/cadr4
cd cadr4
make
```

All build artifacts are created under `build` directory.

### Run

#### Run Tests

```
make check
```

runs all available tests.

#### Run CADR

A special testbench cadr_tb is autogenerated by make (build/cadr_tb.vhd), and it connects everything in CADR and ICMEM. It can be run with:

```
make run-cadr
```

## waveform.opt file

If there is a `X_tb.opt` file next to `X_tb.vhd`, it is used as waveform options file in GHDL (`--read-wave-opt`).

Because cadr_tb is autogenerated under build dir, its opt file is specifically set to cadr_tb.opt in the project root.

If the file contains "recreate" in its first line, the file is deleted and recreated. This will show all signal paths.

If the file contains "ignore" in its first line, the file is ignored, `--read-wave-opt` is not used.

## File Organization

- cadr: cadr components based on CADR schematics
- dip: dip components used by cadr components
- doc: various documents and resources
- ghdl-uart:
- helper: non-CADR components required to run cadr_tb
- rom: ROM files loaded to CADR (P)ROMs and RAMs
- scripts: utility scripts
- soap: utility to generate cadr_*_suds.vhd files
- ttl: ttl components used by dip components

Each folder have a README.md containing more information.

|   cadr_tb     |
| cadr |        |
| dip  | helper |
| ttl  |        |
|     GHDL      |

## Packages

- work.cadr: cadr components
- work.dip: dip components
- work.amd,ecc,fairchild,intel,signetics,sn74,other: ttl components
- work.misc: misc functions and procedures (no components)

## Documentation

- [The CADR Microprocessor](https://tumbleweed.nu/r/lm-3/uv/cadr.html)
- [Implementation of a List Processing Machine](https://tumbleweed.nu/r/lm-3/uv/knight-thesis.html)
- [CADR Schematics](https://tumbleweed.nu/lm-3/schematics.html)
- [Interactive CADR Schematics](https://www.nexoid.at/cadr/clock1.html)
